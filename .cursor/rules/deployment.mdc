---
description: 
globs: 
alwaysApply: true
---
### ðŸš€ deployment.mdc

#### Goal:
Ensure optimal deployment for speed, uptime, and cost-efficiency using Vercel.

---

#### Vercel Configuration
- âœ… Use default Serverless Functions (API routes)
- âœ… Use `vercel.json` to specify routes and headers:
```json
{
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        { "key": "Cache-Control", "value": "public, max-age=31536000, immutable" },
        { "key": "Content-Encoding", "value": "br" }
      ]
    }
  ],
  "functions": {
    "api/remove-bg/route.ts": {
      "maxDuration": 20
    }
  }
}
```

---

#### Static Optimization
- âœ… Enable Image Optimization in `next.config.js`
- âœ… Use ISR or static pages only (no SSR needed)
- âœ… Purge unused CSS in Tailwind

---

#### Vercel Best Practices
- âœ… Auto-deploy from GitHub main branch
- âœ… Add environment variables for Replicate keys only in dashboard
- âœ… Enable analytics for monitoring
- âœ… Ping API route periodically to prevent cold starts

---

#### Rule Summary
âœ… Enforced:
- API max duration
- CDN-cached assets
- Proper compression
- Fully static pages with dynamic API

ðŸš« Avoid:
- Dynamic SSR pages
- Hardcoded secrets in source
- Uploading to static assets
